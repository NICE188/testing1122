<!doctype html>
<html lang="{{ 'zh' if lang=='zh' else 'en' }}">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>{{ t["login"] }} · {{ t["app_name"] }}</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b1020; --glass:#0f172aee; --text:#e7ebf3; --muted:#9fb0cc;
      --brand:#7c9dff; --brand2:#c19cff; --gold:#f7c948;
      --ring: rgba(124,157,255,.45); --ring2: rgba(193,156,255,.35);
      --error:#ef4444; --line: rgba(148,163,184,.15);
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{
      margin:0; color:var(--text);
      font:15px/1.55 Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"PingFang SC","Microsoft YaHei",sans-serif;
      background: radial-gradient(1200px 800px at 10% -10%, rgba(124,157,255,.20), transparent 45%),
                  radial-gradient(1200px 800px at 110% 0%, rgba(193,156,255,.14), transparent 50%),
                  linear-gradient(180deg, #0a0f1e, #0b1224 40%, #0a0f1e);
      overflow:auto;
    }
    /* 动态极光 */
    .aurora{
      position:fixed; inset:0; z-index:-1; pointer-events:none;
    }
    .aurora::before{
      content:""; position:absolute; inset:-40%; filter:blur(40px);
      background:
        conic-gradient(from 0deg, rgba(124,157,255,.22), rgba(193,156,255,.22), rgba(247,201,72,.18), rgba(124,157,255,.22));
      animation:spin 26s linear infinite;
      opacity:.75;
    }
    @keyframes spin { to { transform:rotate(1turn)}}

    /* 居中容器 */
    .wrap{ min-height:100dvh; display:grid; place-items:center; padding:32px; }

    /* 玻璃拟态卡片 + 霓虹描边 */
    .card{
      position:relative; width:min(560px, 92vw);
      background:var(--glass); backdrop-filter: blur(14px) saturate(1.05);
      border:1px solid var(--line); border-radius:18px; padding:26px 28px 18px;
      box-shadow:
        0 12px 50px rgba(0,0,0,.45),
        inset 0 1px 0 rgba(255,255,255,.06);
      transform: perspective(900px) rotateX(.5deg);
    }
    .card::before{
      content:""; position:absolute; inset:-1px; border-radius:18px;
      padding:1px; background:
        linear-gradient(180deg, rgba(124,157,255,.45), rgba(193,156,255,.25), rgba(247,201,72,.25));
      -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
      -webkit-mask-composite: xor; mask-composite: exclude;
      pointer-events:none;
    }
    .title{
      display:flex; align-items:center; gap:10px;
      font-size:22px; font-weight:800; letter-spacing:.3px; margin:2px 0 14px;
    }
    .title .dot{ width:10px; height:10px; border-radius:50%;
      background:radial-gradient(circle at 30% 30%, #fff, #fff0 45%),
                 linear-gradient(135deg, var(--brand), var(--brand2));
      box-shadow:0 0 18px rgba(124,157,255,.65);
    }

    /* 表单字段 */
    .field{ margin-bottom:12px; }
    .label{ font-size:12px; color:var(--muted); margin:0 0 6px 2px; letter-spacing:.2px; }
    .control{
      display:flex; align-items:center; gap:10px;
      border:1px solid var(--line); border-radius:12px; padding:10px 12px;
      background:linear-gradient(180deg, rgba(13,20,40,.9), rgba(10,16,30,.85));
      transition:border-color .18s ease, box-shadow .18s ease, background .18s ease;
    }
    .control:focus-within{
      border-color: rgba(124,157,255,.55);
      box-shadow: 0 0 0 4px rgba(124,157,255,.14), 0 0 0 1px rgba(193,156,255,.25) inset;
      background:linear-gradient(180deg, rgba(16,24,48,.96), rgba(12,18,36,.92));
    }
    .icon{ width:18px; height:18px; opacity:.8 }
    input{
      all:unset; color:var(--text); flex:1; min-height:22px;
      caret-color: var(--brand); letter-spacing:.2px;
    }
    input::placeholder{ color:#95a3bd; opacity:.9 }

    /* 错误提示 */
    .error{
      display:flex; align-items:center; gap:8px;
      margin:8px 2px 2px; padding:8px 10px;
      border-radius:10px; border:1px solid rgba(239,68,68,.35);
      background: linear-gradient(180deg, rgba(239,68,68,.18), rgba(239,68,68,.10));
      color:#fecaca; font-size:13px;
    }

    /* 提交按钮 */
    .actions{ margin-top:10px; display:flex; align-items:center; justify-content:space-between; gap:12px; }
    .btn{
      display:inline-flex; align-items:center; justify-content:center;
      gap:10px; padding:10px 14px; border-radius:12px;
      border:1px solid rgba(148,163,184,.28);
      color:#0b1020; cursor:pointer; font-weight:700; letter-spacing:.2px;
      background:linear-gradient(135deg, var(--brand), var(--brand2) 60%, var(--gold));
      box-shadow: 0 8px 28px rgba(124,157,255,.35);
      transition: transform .12s ease, filter .12s ease;
    }
    .btn:hover{ filter:brightness(1.05) }
    .btn:active{ transform:translateY(1px) }

    /* 语言切换（分段选择） */
    .lang{
      margin-top:12px; color:var(--muted); display:flex; align-items:center; gap:10px;
    }
    .seg{
      display:inline-grid; grid-auto-flow:column; gap:0; padding:3px; border-radius:999px;
      background:rgba(148,163,184,.12); border:1px solid rgba(148,163,184,.22);
    }
    .seg a{
      padding:6px 10px; border-radius:999px; text-decoration:none; color:#cbd5e1; font-weight:600;
    }
    .seg a.active{ background:linear-gradient(135deg, rgba(124,157,255,.35), rgba(193,156,255,.25)); color:#fff; }

    /* 顶部柔光 */
    .card::after{
      content:""; position:absolute; left:16px; right:16px; top:-2px; height:80px; pointer-events:none;
      background: radial-gradient(160px 60px at 14% 0, rgba(124,157,255,.45), transparent 70%),
                  radial-gradient(180px 70px at 82% 0, rgba(193,156,255,.35), transparent 70%),
                  linear-gradient(180deg, rgba(255,255,255,.10), transparent 60%);
      border-top-left-radius:16px; border-top-right-radius:16px; opacity:.9;
    }

    /* 小屏优化 */
    @media (max-width:480px){
      .card{ padding:22px 18px 14px; }
      .title{ font-size:20px }
      .btn{ width:100% }
      .actions{ flex-direction:column; align-items:stretch }
    }
  </style>
</head>
<body>
  <div class="aurora"></div>

  <div class="wrap">
    <div class="card" role="dialog" aria-labelledby="title">
      <div class="title" id="title">
        <span class="dot"></span>
        <span>{{ t["login"] }}</span>
      </div>

      {% if error %}
      <div class="error">
        <svg class="icon" viewBox="0 0 24 24" fill="none"><path d="M12 9v4m0 4h.01M12 3l9 9-9 9-9-9 9-9Z" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
        <span>{{ error }}</span>
      </div>
      {% endif %}

      <form method="post" action="{{ url_for('login') }}" novalidate>
        <input type="hidden" name="next" value="{{ next_url or '/' }}" />

        <div class="field">
          <div class="label">{{ t["username"] }}</div>
          <div class="control">
            <svg class="icon" viewBox="0 0 24 24" fill="none"><path d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-5 0-9 2.5-9 5.5V21h18v-1.5C21 16.5 17 14 12 14Z" stroke="currentColor" stroke-width="1.2" opacity=".85"/></svg>
            <input name="username" autocomplete="username" placeholder="{{ t['username'] }}" required />
          </div>
        </div>

        <div class="field">
          <div class="label">{{ t["password"] }}</div>
          <div class="control">
            <svg class="icon" viewBox="0 0 24 24" fill="none"><path d="M7 10V7a5 5 0 0 1 10 0v3M6 10h12v10H6Z" stroke="currentColor" stroke-width="1.2" opacity=".85"/></svg>
            <input name="password" type="password" autocomplete="current-password" placeholder="{{ t['password'] }}" required />
          </div>
        </div>

        <div class="actions">
          <button class="btn" type="submit">{{ t["login"] }}</button>
        </div>
      </form>

      <div class="lang">
        <span>{{ t["language"] }}：</span>
        <span class="seg">
          <a href="{{ url_for('login', next=next_url, lang='zh') }}" class="{{ 'active' if lang=='zh' else '' }}">中文</a>
          <a href="{{ url_for('login', next=next_url, lang='en') }}" class="{{ 'active' if lang=='en' else '' }}">English</a>
        </span>
      </div>
    </div>
  </div>
</body>
</html>
